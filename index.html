<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>iOS Demo</title>
<style>
body{margin:0;font-family:Arial;background:#111;color:white}
.nav{display:flex;justify-content:center;background:#222}
.nav button{margin:10px;padding:10px}
.home-screen{position:relative;width:100vw;height:calc(100vh - 50px)}
.app-icon{position:absolute;width:80px;text-align:center;cursor:pointer}
.modal{position:fixed;inset:0;background:#000;display:none;flex-direction:column}
.close-btn{position:absolute;top:10px;right:10px}
iframe{flex:1;border:none}
.app-store-grid{display:grid;grid-template-columns:repeat(auto-fill,120px);gap:10px;padding:20px}
.app-store-tile{background:#222;padding:10px;text-align:center}
input,textarea{width:90%;margin:5px}
.star{cursor:pointer}
</style>
</head>

<body>

<div class="nav">
  <button onclick="showHome()">Home</button>
  <button onclick="showInfo()">Info</button>
  <button onclick="showDemo()">Demo</button>
  <button onclick="showAccount()">Account</button>
</div>

<div id="content"></div>

<div class="modal" id="appModal">
  <button class="close-btn" onclick="closeApp()">‚úñ</button>
  <div id="appContent" style="flex:1;display:flex;flex-direction:column"></div>
</div>

<script>
const content=document.getElementById('content');
const appModal=document.getElementById('appModal');
const appContent=document.getElementById('appContent');

let currentUser=localStorage.getItem('currentUser');
let users=JSON.parse(localStorage.getItem('users'))||{};
let devApps=JSON.parse(localStorage.getItem('devApps'))||[];

const preloadedApps=[
 {name:'Minecraft',icon:'üü©',url:'https://classic.minecraft.net/',dev:'Official'},
 {name:'Candy Crush',icon:'üç¨',url:'https://www.candycrushsaga.com/',dev:'King'},
 {name:'Subway Surfers',icon:'üöÜ',url:'https://subwaysurfers.com/',dev:'SYBO'}
];

function getUserData(){
 if(!users[currentUser]){
  users[currentUser]={installed:[],ratings:{},permissions:{},isDev:false};
 }
 return users[currentUser];
}

function saveUsers(){
 localStorage.setItem('users',JSON.stringify(users));
}

function showAccount(){
 if(!currentUser){
  content.innerHTML=`
   <h2>Login / Sign Up</h2>
   <input id="userName" placeholder="Username">
   <button onclick="login()">Login / Sign Up</button>`;
 }else{
  const u=getUserData();
  content.innerHTML=`
   <h2>Account: ${currentUser}</h2>
   <p>Developer Mode: ${u.isDev?'ON ‚úÖ':'OFF'}</p>
   <button onclick="toggleDev()">Toggle Developer Mode</button>
   <button onclick="logout()">Logout</button>
   ${u.isDev?developerPanel():''}`;
 }
}

function login(){
 const name=document.getElementById('userName').value.trim();
 if(!name) return;
 currentUser=name;
 localStorage.setItem('currentUser',name);
 showHome();
}

function logout(){
 localStorage.removeItem('currentUser');
 currentUser=null;
 showAccount();
}

function toggleDev(){
 const u=getUserData();
 u.isDev=!u.isDev;
 saveUsers();
 showAccount();
}

function developerPanel(){
 return `
 <h3>Developer Upload</h3>
 <input id="appName" placeholder="App Name">
 <input id="appIcon" placeholder="Icon (emoji)">
 <input id="appURL" placeholder="App URL">
 <textarea id="appDesc" placeholder="Description"></textarea>
 <button onclick="uploadApp()">Upload App</button>`;
}

function uploadApp(){
 const app={
  name:appName.value,
  icon:appIcon.value||'üì¶',
  url:appURL.value,
  desc:appDesc.value,
  dev:currentUser,
  verified:true
 };
 devApps.push(app);
 localStorage.setItem('devApps',JSON.stringify(devApps));
 alert('App uploaded!');
}

function showHome(){
 if(!currentUser){showAccount();return;}
 let html='<div class="home-screen">';
 const u=getUserData();
 const system=['Settings','Browser','App Store'];
 [...system,...u.installed.map(a=>a.name)].forEach((a,i)=>{
  html+=`
  <div class="app-icon"
   style="left:${20+(i%4)*90}px;top:${20+Math.floor(i/4)*100}px"
   onclick="openApp('${a}')">
   üì±<br>${a}</div>`;
 });
 html+='</div>';
 content.innerHTML=html;
}

function openApp(name){
 const u=getUserData();
 const app=[...preloadedApps,...devApps].find(a=>a.name===name);
 if(app){
  if(!requestPermission(name,'browser'))return;
  appContent.innerHTML=`<iframe src="${app.url}"></iframe>`;
  appModal.style.display='flex';
 }
 if(name==='App Store'){openStore();}
}

function openStore(){
 const u=getUserData();
 appContent.innerHTML=`<div class="app-store-grid" id="grid"></div>`;
 appModal.style.display='flex';
 const grid=document.getElementById('grid');
 [...preloadedApps,...devApps].forEach(app=>{
  const r=u.ratings[app.name]||0;
  const installed=u.installed.some(a=>a.name===app.name);
  const tile=document.createElement('div');
  tile.className='app-store-tile';
  tile.innerHTML=`
   <div style="font-size:30px">${app.icon}</div>
   <b>${app.name}</b><br>
   <small>${app.dev}${app.verified?' ‚úÖ':''}</small>
   <p style="font-size:12px">${app.desc||''}</p>
   <div>${[1,2,3,4,5].map(s=>`
    <span class="star" style="color:${s<=r?'gold':'gray'}"
     onclick="rate('${app.name}',${s})">‚òÖ</span>`).join('')}</div>
   <button onclick="${installed?`remove('${app.name}')`:`install('${app.name}')`}">
    ${installed?'Remove':'Install'}
   </button>`;
  grid.appendChild(tile);
 });
}

function install(name){
 const u=getUserData();
 const app=[...preloadedApps,...devApps].find(a=>a.name===name);
 u.installed.push(app);
 saveUsers(); showHome(); openStore();
}

function remove(name){
 const u=getUserData();
 u.installed=u.installed.filter(a=>a.name!==name);
 saveUsers(); showHome(); openStore();
}

function rate(name,r){
 const u=getUserData();
 u.ratings[name]=r;
 saveUsers(); openStore();
}

function requestPermission(app,p){
 const u=getUserData();
 if(!u.permissions[app])u.permissions[app]=[];
 if(!u.permissions[app].includes(p)){
  if(confirm(`${app} wants ${p} access. Allow?`)){
   u.permissions[app].push(p); saveUsers(); return true;
  }
  return false;
 }
 return true;
}

function closeApp(){appModal.style.display='none'}

showHome();
</script>
</body>
</html>
