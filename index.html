<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Zetro's gallery</title>
  <style>
    /* Theme: black & blue with sword / pixel accents */
    :root{
      --bg:#0b0f14;
      --panel:#07101a;
      --accent:#0ea5ff;
      --accent2:#3b82f6;
      --glass: rgba(255,255,255,0.03);
      --muted: rgba(255,255,255,0.65);
      --danger: #ff6b6b;
    }
    html,body{height:100%;}
    body{
      margin:0; font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(14,165,255,0.06), transparent 8%),
                  radial-gradient(800px 400px at 90% 90%, rgba(59,130,246,0.04), transparent 6%),
                  var(--bg);
      color:#e6eef6;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow:hidden;
    }

    /* Big sign */
    header{
      display:flex; align-items:center; gap:16px; padding:28px 36px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      box-shadow: inset 0 -1px 0 rgba(255,255,255,0.02);
    }
    h1{margin:0; font-size:34px; letter-spacing:1px;}
    .subtitle{color:var(--muted); font-size:13px}

    /* layout */
    .wrap{display:grid; grid-template-columns: 1fr 380px; gap:20px; padding:20px; height:calc(100% - 100px);}
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent); border-radius:12px; padding:18px; box-shadow: 0 6px 30px rgba(0,0,0,0.6); overflow:auto}

    /* Gallery */
    .gallery-grid{display:grid; grid-template-columns: repeat(auto-fill,minmax(260px,1fr)); gap:16px}
    .card{background:var(--glass); border:1px solid rgba(255,255,255,0.03); padding:8px; border-radius:10px;}
    .thumbnail{position:relative; padding-top:56.25%; border-radius:8px; overflow:hidden; background:linear-gradient(180deg,#061320,#081628)}
    .thumbnail iframe{position:absolute; inset:0; width:100%; height:100%; border:0}
    .title{font-weight:600; margin-top:8px}
    .meta{color:var(--muted); font-size:12px}

    /* Hidden add button (hard to find) */
    .sword-button{
      position:fixed; right:18px; bottom:18px; width:46px; height:46px; border-radius:50%; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(135deg,var(--accent2),var(--accent)); box-shadow:0 6px 22px rgba(11,34,60,0.6); cursor:pointer; opacity:0.09; transition:opacity .25s,transform .15s;
      z-index:60; backdrop-filter: blur(4px);
    }
    .sword-button:hover{opacity:1; transform:scale(1.06)}
    /* add a tiny label that's very subtle */
    .sword-button[title]{outline: none}

    /* Modal */
    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:100}
    .modal.show{display:flex}
    .modal .box{width:520px; max-width:95%; background:linear-gradient(180deg,#07101a,#071523); border-radius:12px; padding:18px; border:1px solid rgba(255,255,255,0.04)}
    label{display:block; font-size:13px; color:var(--muted); margin-top:8px}
    input[type=text], input[type=password]{width:100%; padding:10px 12px; border-radius:8px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:inherit}
    .row{display:flex; gap:8px}
    .btn{margin-top:12px; padding:10px 14px; border-radius:8px; border:0; cursor:pointer; font-weight:600}
    .btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent2)); color:#021122}
    .btn.ghost{background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted)}

    /* Chat panel */
    .chat{display:flex; flex-direction:column; height:100%}
    .chat-box{flex:1; overflow:auto; padding:8px; display:flex; flex-direction:column; gap:8px}
    .msg{padding:8px 12px; border-radius:10px; background:rgba(255,255,255,0.02); max-width:85%;}
    .msg.me{align-self:flex-end; background:linear-gradient(90deg, rgba(14,165,255,0.12), rgba(59,130,246,0.07));}
    .msg .who{font-size:12px; color:var(--muted); margin-bottom:4px}
    .chat-controls{display:flex; gap:8px; margin-top:8px}
    .username-set{display:flex; gap:8px; align-items:center; margin-bottom:8px}

    /* decorations */
    .sword-deco{position:absolute; left:-120px; top:10px; opacity:0.06; transform:rotate(-25deg); width:520px}
    .minecraft-block{width:56px; height:56px; border-radius:8px; box-shadow: inset 0 -6px 12px rgba(0,0,0,0.6)}

    footer{position:fixed; left:20px; bottom:12px; color:var(--muted); font-size:12px}

    @media(max-width:880px){
      .wrap{grid-template-columns: 1fr}
      .sword-button{right:10px; bottom:10px}
    }

  </style>
</head>
<body>
  <header>
    <!-- subtle sword SVG left -->
    <svg class="sword-deco" viewBox="0 0 800 200" xmlns="http://www.w3.org/2000/svg" aria-hidden>
      <g fill="none" stroke="white" stroke-opacity="0.8" stroke-width="6">
        <path d="M40 160 L180 30 L360 60 L560 20" stroke-opacity="0.04"/>
      </g>
    </svg>
    <div style="display:flex;flex-direction:column">
      <h1>Zetro's gallery</h1>
      <div class="subtitle">A YouTube gallery — hidden add, persistent chat, black & blue theme</div>
    </div>
    <div style="flex:1"></div>
    <div style="display:flex; gap:12px; align-items:center">
      <div style="display:flex;align-items:center;gap:8px">
        <div class="minecraft-block" style="background:linear-gradient(180deg,#2e7d32,#1b5e20); display:flex; align-items:center; justify-content:center; color:#07101a; font-weight:700">MC</div>
      </div>
    </div>
  </header>

  <div class="wrap">
    <main class="panel">
      <h2 style="margin-top:0">Gallery</h2>
      <div id="gallery" class="gallery-grid"></div>
    </main>

    <aside class="panel" style="display:flex; flex-direction:column">
      <h3 style="margin:0 0 8px 0">Chat</h3>
      <div class="chat" id="chatRoot">
        <div>
          <div class="username-set">
            <input id="usernameInput" type="text" placeholder="Set username" style="padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit" />
            <button id="setNameBtn" class="btn ghost">Set</button>
            <button id="clearData" class="btn ghost">Clear all saved</button>
          </div>
        </div>
        <div class="chat-box" id="messages"></div>
        <div class="chat-controls">
          <input id="msgInput" type="text" placeholder="Say something..." style="flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit" />
          <button id="sendBtn" class="btn primary">Send</button>
        </div>
      </div>
    </aside>
  </div>

  <!-- Hidden / hard to find add button -->
  <div id="addBtn" class="sword-button" title="?">
    <!-- small sword icon -->
    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden>
      <rect x="11" y="2" width="2" height="12" rx="1" fill="white" fill-opacity="0.9" />
      <path d="M6 18 L8 16 L16 8 L18 10 L10 18 Z" fill="white" fill-opacity="0.9" />
    </svg>
  </div>

  <!-- Modal for adding a video -->
  <div id="modal" class="modal" aria-hidden>
    <div class="box" role="dialog" aria-modal="true">
      <h3>Add a video</h3>
      <p style="color:var(--muted);font-size:13px;margin-top:6px">Enter a YouTube link (or paste share link), a title, and the password.</p>
      <label>Video URL</label>
      <input id="videoUrl" type="text" placeholder="https://www.youtube.com/watch?v=..." />
      <label>Title</label>
      <input id="videoTitle" type="text" placeholder="Cool montage" />
      <label>Password</label>
      <input id="videoPass" type="password" placeholder="password" />
      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button id="cancelAdd" class="btn ghost">Cancel</button>
        <button id="confirmAdd" class="btn primary">Add video</button>
      </div>
    </div>
  </div>

  <footer>Built for Zetro • Theme: black & blue</footer>

  <script>
    /*********************
      Persistence keys & config
    **********************/
    const STORAGE_KEYS = {
      VIDEOS: 'zetro_videos_v1',
      CHAT: 'zetro_chat_v1',
      USER: 'zetro_user_v1'
    };
    const ADD_PASSWORD = '.Elanuel10'; // the required password exactly as requested

    /*********************
      Utilities
    **********************/
    function qs(sel){return document.querySelector(sel)}
    function qsa(sel){return Array.from(document.querySelectorAll(sel))}

    function extractYouTubeID(url){
      try{
        // handle many common formats
        const u = url.trim();
        if(!u) return null;
        // common patterns
        const vMatch = u.match(/[?&]v=([A-Za-z0-9_-]{6,})/);
        if(vMatch) return vMatch[1];
        const shortMatch = u.match(/youtu\.be\/([A-Za-z0-9_-]{6,})/);
        if(shortMatch) return shortMatch[1];
        const embedMatch = u.match(/embed\/([A-Za-z0-9_-]{6,})/);
        if(embedMatch) return embedMatch[1];
        // sometimes full url is just id
        if(/^[A-Za-z0-9_-]{11}$/.test(u)) return u;
        return null;
      }catch(e){return null}
    }

    /*********************
      Gallery
    **********************/
    function loadVideos(){
      const raw = localStorage.getItem(STORAGE_KEYS.VIDEOS);
      if(!raw) return [];
      try{ return JSON.parse(raw) }catch(e){ return [] }
    }
    function saveVideos(arr){ localStorage.setItem(STORAGE_KEYS.VIDEOS, JSON.stringify(arr)) }

    function renderGallery(){
      const g = qs('#gallery'); g.innerHTML='';
      const videos = loadVideos();
      if(videos.length===0){
        g.innerHTML = `<div style="color:var(--muted);grid-column:1/-1;padding:40px;text-align:center">No videos yet. Find the hidden sword to add one.</div>`
        return;
      }
      videos.forEach((v,idx)=>{
        const c = document.createElement('div'); c.className='card';
        c.innerHTML = `
          <div class="thumbnail"><iframe src="https://www.youtube.com/embed/${encodeURIComponent(v.id)}" allowfullscreen loading="lazy"></iframe></div>
          <div class="title">${escapeHtml(v.title||'Untitled')}</div>
          <div class="meta">added ${new Date(v.added).toLocaleString()}</div>
          <div style="margin-top:8px;text-align:right"><button data-i="${idx}" class="btn ghost removeBtn">Remove</button></div>
        `;
        g.appendChild(c);
      });
      qsa('.removeBtn').forEach(b=> b.addEventListener('click', (e)=>{
        const i = Number(e.currentTarget.getAttribute('data-i'));
        const arr = loadVideos(); arr.splice(i,1); saveVideos(arr); renderGallery();
      }))
    }

    function escapeHtml(s){ return String(s).replace(/[&<>"']/g, function(m){return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[m]}) }

    /*********************
      Add video modal flow
    **********************/
    const addBtn = qs('#addBtn');
    const modal = qs('#modal');
    const cancelAdd = qs('#cancelAdd');
    const confirmAdd = qs('#confirmAdd');

    addBtn.addEventListener('click', ()=>{
      // open modal but keep it subtle — maybe require a long click? We just show it
      modal.classList.add('show'); modal.setAttribute('aria-hidden','false');
      qs('#videoUrl').focus();
    })
    cancelAdd.addEventListener('click', ()=>{ modal.classList.remove('show'); modal.setAttribute('aria-hidden','true') })

    confirmAdd.addEventListener('click', ()=>{
      const url = qs('#videoUrl').value.trim();
      const title = qs('#videoTitle').value.trim() || 'Untitled';
      const pass = qs('#videoPass').value;
      if(pass !== ADD_PASSWORD){ alert('Incorrect password.'); return; }
      const id = extractYouTubeID(url);
      if(!id){ alert('Could not detect a valid YouTube video ID from that URL. Try a share link or the full URL.'); return; }
      const arr = loadVideos();
      arr.unshift({id, title, added: Date.now()});
      saveVideos(arr); renderGallery();
      qs('#videoUrl').value=''; qs('#videoTitle').value=''; qs('#videoPass').value='';
      modal.classList.remove('show'); modal.setAttribute('aria-hidden','true');
    })

    // click outside modal closes
    modal.addEventListener('click', (e)=>{ if(e.target===modal){ modal.classList.remove('show'); modal.setAttribute('aria-hidden','true') } })

    /*********************
      Chat (persistent) - simple localStorage-backed chat
    **********************/
    function loadChat(){
      const raw = localStorage.getItem(STORAGE_KEYS.CHAT); if(!raw) return []; try{return JSON.parse(raw)}catch(e){return[]}
    }
    function saveChat(arr){ localStorage.setItem(STORAGE_KEYS.CHAT, JSON.stringify(arr)) }

    function renderChat(){
      const box = qs('#messages'); box.innerHTML='';
      const msgs = loadChat();
      const currentUser = localStorage.getItem(STORAGE_KEYS.USER) || 'Anonymous';
      msgs.forEach(m=>{
        const el = document.createElement('div'); el.className = 'msg' + (m.user===currentUser ? ' me':'');
        el.innerHTML = `<div class="who">${escapeHtml(m.user)}</div><div class="body">${escapeHtml(m.text)}</div><div style="font-size:11px;color:var(--muted);margin-top:6px">${new Date(m.ts).toLocaleString()}</div>`;
        box.appendChild(el);
      });
      box.scrollTop = box.scrollHeight;
    }

    qs('#setNameBtn').addEventListener('click', ()=>{
      const val = qs('#usernameInput').value.trim() || 'Anonymous';
      localStorage.setItem(STORAGE_KEYS.USER, val); alert('Username set to ' + val); renderChat();
    })

    qs('#sendBtn').addEventListener('click', sendMessage);
    qs('#msgInput').addEventListener('keydown', (e)=>{ if(e.key==='Enter') sendMessage(); });

    function sendMessage(){
      const text = qs('#msgInput').value.trim(); if(!text) return; const user = localStorage.getItem(STORAGE_KEYS.USER) || 'Anonymous';
      const arr = loadChat(); arr.push({user, text, ts: Date.now()}); saveChat(arr); qs('#msgInput').value=''; renderChat();
    }

    qs('#clearData').addEventListener('click', ()=>{
      if(confirm('Clear all saved gallery and chat data? This cannot be undone.')){
        localStorage.removeItem(STORAGE_KEYS.VIDEOS); localStorage.removeItem(STORAGE_KEYS.CHAT); localStorage.removeItem(STORAGE_KEYS.USER);
        renderGallery(); renderChat(); alert('Cleared.');
      }
    })

    /*********************
      UX niceties
    **********************/
    // Make add button very subtle — reduce opacity until mouse is near
    (function subtleButtonBehavior(){
      const btn = addBtn;
      document.addEventListener('mousemove', (e)=>{
        const rect = btn.getBoundingClientRect();
        const dx = e.clientX - (rect.left + rect.width/2);
        const dy = e.clientY - (rect.top + rect.height/2);
        const dist = Math.hypot(dx,dy);
        // if cursor gets within 120px, reveal button
        const o = Math.max(0.08, Math.min(1, 1 - (dist - 60)/220));
        btn.style.opacity = o;
      });
      // also small keyboard shortcut: press Shift+A to open
      document.addEventListener('keydown', (e)=>{ if(e.shiftKey && e.key.toLowerCase()==='a'){ btn.click(); } })
    })();

    // initial render
    renderGallery(); renderChat();

    // small helper to populate demo if empty (optional) - commented out
    /*
    if(loadVideos().length===0){
      const demo = [{id:'dQw4w9WgXcQ', title:'Demo Video', added: Date.now()}]; saveVideos(demo); renderGallery();
    }
    */

    // accessibility: focus trap when modal open (simple)
    document.addEventListener('keydown', (e)=>{
      if(e.key==='Escape'){
        if(modal.classList.contains('show')){ modal.classList.remove('show'); modal.setAttribute('aria-hidden','true') }
      }
    })

  </script>
</body>
</html>
